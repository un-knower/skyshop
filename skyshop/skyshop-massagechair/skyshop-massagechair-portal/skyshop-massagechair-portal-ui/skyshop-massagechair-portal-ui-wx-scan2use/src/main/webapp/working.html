<!DOCTYPE html>
<html>
	<head>
		<title>正在按摩 - 三网通-按摩椅</title>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
		<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, width=device-width"/>
		<meta name="apple-mobile-web-app-capable" content="yes"/>
		<meta http-equiv="keywords" content="三网通-按摩椅"/>
		<meta http-equiv="description" content="三网通-按摩椅"/>
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="renderer"  content="webkit|ie-comp|ie-stand">
		
		<link rel="stylesheet" type="text/css" href="plugins/jqweui/lib/weui.css"/>
		<link rel="stylesheet" type="text/css" href="plugins/jqweui/css/jquery-weui.css"/>
		
		<link rel="stylesheet" type="text/css" href="css/style.css"/>
		
		<script type="text/javascript" src="plugins/jqweui/lib/jquery-2.1.4.js"></script>
		<script type="text/javascript" src="plugins/jqweui/js/jquery-weui.js"></script>
		<script type="text/javascript" src="js/ctx.js"></script>
		<script type="text/javascript" src="js/ui.js"></script>
		
		<script type="text/javascript">
			$(function() {
			    var search = window.location.search;
			    
			    if(search && search.length > 1) {
				    search = search.substring(1);
				    
				    var paramObj = {};
				    var params = search.split('&');
				    for (var i = 0; i < params.length; i++) {
                        var p = params[i];
                        if(p && p.indexOf('=') != -1) {
                            var pair = p.split('=');
                            paramObj[pair[0]] = pair[1];
                        }
                    }
			    }
			    var servicemins = 0;
			    if(paramObj['mins']) {
				    servicemins = parseInt(paramObj['mins']);
			    }
			    
			    var chair_price_name = '';
			    if(paramObj['chair_price_name']) {
			        chair_price_name = paramObj['chair_price_name'];
			    }
			    
			    var hours = Math.floor(servicemins/60);
			    $('#mins').val(servicemins - hours * 60);
			    $('#hours').val(hours);
			    $('#seconds').val(0);
			    
			    if(servicemins > 0) {
			        doAjax(api_server_url + '/order/timetik/' + servicemins, function(){
			            // 计时
			        }, 'POST');
			        
				    var clock = setInterval(function(){
				        var hours = parseInt($('#hours').val());
				        var mins = parseInt($('#mins').val());
				        var seconds = parseInt($('#seconds').val());
				        
				        seconds = seconds - 1;
				        
				        if(mins > 0) {
					        if(seconds < 0) {
					            seconds = 59;
					            mins = mins - 1;
					            
					            if(hours > 0) {
						            if(mins < 0) {
						            	mins = 59;
						            	hours = hours - 1;
						            }
					            }
					        }
				        } else {
				            if(seonds == 0) {
				                clearInterval(clock);
				                $('.btns').show();
				            }
				        }
				        
				        $('#hours').val(hours);
					    $('#mins').val(mins);
					    $('#seconds').val(seconds);
				    }, 1000);
			    }
			    
			    $('.btns').hide();
			});
		</script>
	</head>
	<body>
		<div class="header" >
		</div>
		<div class="content">
			<div class="servicetime">剩余时间：</div>
			<div>
				<input class="time" id="hours" value="0" readonly="readonly" /><span class="timeunit">时</span>
				<input class="time" id="mins" value="20" readonly="readonly"/><span class="timeunit">分</span>
				<input class="time" id="seconds" value="0" readonly="readonly"/><span class="timeunit">秒</span>
			</div>
			<div class="btns">
				<a class="a" href="index.html">返回首页</a>
			</div>
		</div>
	</body>
</html>